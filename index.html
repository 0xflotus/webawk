<!doctype html>
<html lang="en-us">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>WebAWK - client-side awk in Javascript</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js"></script>
    <script src="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/js/bootstrap.min.js"></script>
    <link href="http://netdna.bootstrapcdn.com/twitter-bootstrap/2.2.1/css/bootstrap-combined.min.css" rel="stylesheet">
    <!-- link href="custom.css" rel="stylesheet" /-->


  </head>
  <body>

	<header class="jumbotron subhead" id="overview">
		<div class="container">
			<h1>WebAWK - AWK in Javascript</h1>
			<p class="lead">Enjoy AWK without leaving your browser.</p>
		</div>
	</header>

	<div class="container">

		<!-- Introduction -->

		<div class="row">
			<div class="span6">
				<h3>What is AWK?</h3>
				<ul>
					<li>AWK is a programming language typically for text processing</li>
					<li>AWK is an established, solid, stable language - invented in 1977.</li>
					<li>Named after its authors: <a href="http://en.wikipedia.org/wiki/Alfred_Aho">Alfred <b>A</b>ho</a>, <a href="http://en.wikipedia.org/wiki/Peter_J._Weinberger">Peter <b>W</b>einberger</a> and <a href="http://en.wikipedia.org/wiki/Brian_Kernighan">Brian <b>K</b>ernighan</a>.</li>
					<li>AWK is commonly pronounced as an acronym, like the bird <a href="http://en.wikipedia.org/wiki/Auk">Auk</a>.</li>
					<li>See below for more information and links.</li>
				</ul>
			</div>
			<div class="span6">
				<h3>What is this website for?</h3>
				<ul>
					<li>On this website you can experiment with small AWK programs, and explore how AWK programs work.</li>
					<li>Like other programing language (e.g Perl and Python), AWK is more commonly used on servers, or on your local laptop/desktop computer (as opposed to your webbrowser).</li>
				</ul>
			</div>
		</div>

		<!-- Input Section -->

		<div class="row">
			<div class="span12">
				<h3>AWK Examples</h3>
				The most common scenario is running an AWK program (or script) on a given input file, to produce some output file.<p>
				Choose an example below, and click <span class="label">run</span> to see how AWK processes the input file.<p>

				Examples:
				<select onchange="set_example_select(this)">
					<option value="">Select an example</option>
					<option value="ex1">Example1</option>
					<option value="ex2">Example2</option>
					<option value="ex3">Example3</option>
				</select>
			</div>
		</div>


		<div class="row">
			<div class="span4">
				<h4>Input File</h4>
				<pre id="input_file">
1   A
2   B
3   C
4   D</pre>
			</div>
			<div class="span4">
				<h4>AWK program</h4>
				<pre id="awk_program">
BEGIN {
  print "Hello from Web/AWK World"
}
$2 ~ /C/ { print $1 * 2 }</pre>

			<button class="button btn-primary" id="run_awk" onclick="go_awk_go()">Run</button>
			</div>
			<div class="span4">
				<h4>Explanation</h4>
				<div id="awk_program_explanation">
				</div>
			</div>
		</div>
	

		<div class="row">
			<div class="offset2 span8 offset2">
<div style="display: none;" id="awk_error_msg">
	<br/>
<div class="alert alert-error">
Oops! seems like your AWK program failed!<p>
Please check the syntax and try again...
</div>
</div>
				<h4>Output</h4>
				<pre id="output_file">
				</pre>
			</div>
		</div>

		<br/>
		<br/>
		<br/>


		<!-- What's next? -->

		<div class="row">
			<div class="span4">
				<h4>Learn more!</h4>
				<ul>
					<li>AWK on <a href="http://en.wikipedia.org/wiki/AWK">Wikipedia</a>.</li>
					<li>The <a href="http://awk.info/">AWK Community Portal</a>.</li>
					<li>The <a href="http://www.amazon.com/Effective-awk-Programming-Arnold-Robbins/dp/0596000707/ref=pd_sim_b_1">Effective AWK Progamming</a> book.</li>
				</ul>
			</div>

			<div class="span4">
				<h4>Running AWK on your computer</h4>
				If you're using Apple's OS-X, or a linux (e.g. Ubuntu) - you already have AWK installed!</p>
				If you're using Microsoft Windows, you can download the program here: <a href="http://gnuwin32.sourceforge.net/packages/gawk.htm">GNU AWK for Windows</a>.
				<p>
			</div>

			<div class="span4">
				<h4>About WebAWK</h4>
				WebAWK is an AWK program compiled into Javascript.<p>
				See source code and technical details here: <a href="https://github.com/agordon/webawk">https://github.com/agordon/webawk</a>.
			</div>
		</div>


	</div><!--container -->
		<br/>
		<br/>
		<br/>

<script src="awk_web.js" type='text/javascript'></script>

<script type="text/javascript">

var input_files = {};
var awk_programs = {};
var awk_explanations = {};

input_files["ex1"] = "1   A\n2   B\n3   C\n";
awk_programs["ex1" ] = "$1>2";
awk_explanations["ex1"] = "AWK Patterns are filters - if an input line matches the filter - it will be printed" ;

input_files["ex2"] = "3\n5\n12\n6\n11\n9.3\n";
awk_programs["ex2" ] = "{ print ( $1 * 5 ) }";
awk_explanations["ex2"] = "AWK Actions (inside the curly-braces) will perform an operation on the input file.<<p>Here, we print the value of the first field multiplied by 5." ;

function set_example(value)
{
	$("#input_file").text(input_files[value]);
	$("#awk_program").text(awk_programs[value]);
	$("#awk_program_explanation").html(awk_explanations[value]);
}

function set_example_select(sel)
{
	var value = sel.options[sel.selectedIndex].value;
	set_example(value);
}

function go_awk_go()
{
	var awk_source = $("#awk_program").text();

	var sample_input = $("#input_file").text();

	var awk = run_web_awk( awk_source, sample_input ) ;
	console.log(awk);

	$("#output_file").text (  awk.stderr + "\n" + awk.stdout );

	//show the error <div>
	if (awk.exit_code != 0) {
		$("#awk_error_msg").show();
	} else {
		$("#awk_error_msg").hide();
	}
}


    </script>
  </body>
</html>
